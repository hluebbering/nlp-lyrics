<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hannah Luebbering">
<meta name="dcterms.date" content="2024-04-16">

<title>NLP Song Lyrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01_sentiment_analysis/01_data.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.27.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-title">Overview</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">NLP Song Lyrics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_sentiment_analysis/01_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Extracting Spotify Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_sentiment_analysis/02_nlp.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Natural Language Processing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_genre_classification/01_classification_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Genre Classification Model</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#extracting-spotify-data" id="toc-extracting-spotify-data" class="nav-link" data-scroll-target="#extracting-spotify-data">Extracting Spotify Data</a>
  <ul class="collapse">
  <li><a href="#accessing-the-spotify-web-api" id="toc-accessing-the-spotify-web-api" class="nav-link" data-scroll-target="#accessing-the-spotify-web-api">Accessing the Spotify Web API</a></li>
  <li><a href="#extracting-track-data-from-playlist" id="toc-extracting-track-data-from-playlist" class="nav-link" data-scroll-target="#extracting-track-data-from-playlist">Extracting Track Data From Playlist</a></li>
  </ul></li>
  <li><a href="#natural-language-processing" id="toc-natural-language-processing" class="nav-link" data-scroll-target="#natural-language-processing">Natural Language Processing</a>
  <ul class="collapse">
  <li><a href="#scraping-song-lyrics" id="toc-scraping-song-lyrics" class="nav-link" data-scroll-target="#scraping-song-lyrics">Scraping Song Lyrics</a></li>
  <li><a href="#pre-processing-text-data" id="toc-pre-processing-text-data" class="nav-link" data-scroll-target="#pre-processing-text-data">Pre-Processing Text Data</a></li>
  </ul></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a></li>
  <li><a href="#putting-it-all-together" id="toc-putting-it-all-together" class="nav-link" data-scroll-target="#putting-it-all-together">Putting it All Together</a></li>
  <li><a href="#correlations-matrix" id="toc-correlations-matrix" class="nav-link" data-scroll-target="#correlations-matrix">Correlations Matrix</a></li>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis">Principal Component Analysis</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K Means Clustering</a></li>
  <li><a href="#supervised-learning-similarity-search" id="toc-supervised-learning-similarity-search" class="nav-link" data-scroll-target="#supervised-learning-similarity-search">Supervised Learning: Similarity Search</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">NLP Song Lyrics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hannah Luebbering </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<p><span class="myhighlight">Objective.</span> The following project involves extracting and analyzing Spotify data from top playlists using the Spotify and Genius Lyrics Web API. Natural Language Processing techniques are used to process lyrics and perform sentiment analysis. K-means clustering and PCA analysis are employed to categorize songs and analyze relationships between musical features.</p>
<section id="extracting-spotify-data" class="level2">
<h2 class="anchored" data-anchor-id="extracting-spotify-data">Extracting Spotify Data</h2>
<p>Getting started, we want to extract data for a set of tracks within one of Spotify’s top-featured playlists. Leveraging the <strong>Spotify Web API</strong>, we can seamlessly obtain detailed data for a song, such as the artist, the album it belongs to, its release date, popularity, and audio features like danceability, energy, and tempo.</p>
<section id="accessing-the-spotify-web-api" class="level3">
<h3 class="anchored" data-anchor-id="accessing-the-spotify-web-api">Accessing the Spotify Web API</h3>
<p>Python libraries like <code>spotipy</code> offer a user-friendly way to interact with the Spotify API, offering a range of functions that streamline tasks like API authentication. To authenticate access, we provide a client ID and secret. Once authenticated, we can interact with the API and retrieve data.</p>
<div id="92d35941" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spotipy</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spotipy.oauth2 <span class="im">import</span> SpotifyClientCredentials</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>my_auth <span class="op">=</span> SpotifyClientCredentials(client_id <span class="op">=</span> <span class="st">"xxx"</span>, client_secret <span class="op">=</span> <span class="st">"xxx"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">sp</span> <span class="op">=</span> spotipy.<span class="do">Spotify</span>(auth_manager<span class="op">=</span>my_auth)  <span class="co"># Spotify authentication</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="spotifys-featured-playlists" class="level4">
<h4 class="anchored" data-anchor-id="spotifys-featured-playlists">Spotify’s Featured Playlists</h4>
<p>Let’s take a look at the popular Spotify playlists. Below, the code retrieves a range of Spotify playlists and generates a dataframe containing details for each playlist.</p>
<div id="73b3147d" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">thumbnail</th>
<th data-quarto-table-cell-role="th">playlist_name</th>
<th data-quarto-table-cell-role="th">playlist_id</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td><img src="https://i.scdn.co/image/ab67706f00000002d4f64397019d0744c0bc1ac4" class="img-fluid" width="40"></td>
<td>Today’s Top Hits</td>
<td>37i9dQZF1DXcBWIGoYBM5M</td>
<td>Karol G is on top of the Hottest 50!</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td><img src="https://i.scdn.co/image/ab67706f00000002426dda818d07ebe7ad4c2287" class="img-fluid" width="40"></td>
<td>RapCaviar</td>
<td>37i9dQZF1DX0XUsuxWHRQd</td>
<td>New music from Eminem, Ice Spice and BossMan DLow.</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td><img src="https://i.scdn.co/image/ab67706f00000002f9c51ffc2c7c1a2de4d86073" class="img-fluid" width="40"></td>
<td>Hot Country</td>
<td>37i9dQZF1DX1lVhptIYRda</td>
<td>Today's top country hits. Cover: Megan Moroney</td>
<td>50</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="extracting-track-data-from-playlist" class="level3">
<h3 class="anchored" data-anchor-id="extracting-track-data-from-playlist">Extracting Track Data From Playlist</h3>
<p>Next, we utilize Spotify’s API to extract further details about each song within the playlist. We obtain metadata such as the track name, the artist it’s sung by, the album it belongs to, the release date, and track features such as danceability, tempo, and popularity.</p>
<div id="f0e6309b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="do">get_playlist_tracks</span>(playlist_URI):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> <span class="kw">sp</span>.playlist_tracks(playlist_URI)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    tracks <span class="op">=</span> results[<span class="st">"items"</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> results[<span class="st">"next"</span>]:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="kw">sp</span>.<span class="bu">next</span>(results)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        tracks.extend(results[<span class="st">"items"</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tracks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Choose a specific playlist to analyze by copying the URL from the Spotify Player interface. Using that link, the <code>playlist_tracks</code> method retrieves a list of IDs and corresponding artists for each track from the playlist. Specifically, we analyze Spotify’s <em>Today’s Top Hits</em> playlist.</p>
<iframe width="102%" height="350px" src="./01_sentiment_analysis/genres_plot.html" frameborder="0" allowfullscreen="" style="margin-bottom: -5px;">
</iframe>
<iframe width="100%" height="290px" src="./01_sentiment_analysis/html/track_features.html" frameborder="0" allowfullscreen="" style="margin-bottom: 0px;">
</iframe>
<hr>
</section>
</section>
<section id="natural-language-processing" class="level2">
<h2 class="anchored" data-anchor-id="natural-language-processing">Natural Language Processing</h2>
<p>Using the data gathered from the Spotify API, we now want to extract and process lyrics for each song. This is accomplished through scraping textual lyrical data from the <strong>Genius Lyrics</strong> website. Following extraction, the lyrics are cleaned before undergoing sentiment analysis.</p>
<section id="scraping-song-lyrics" class="level3">
<h3 class="anchored" data-anchor-id="scraping-song-lyrics">Scraping Song Lyrics</h3>
<p>The <code>lyricsgenius</code> is a fundamental library allowing for web scraping of the Genius Lyrics website. Through the initialization of the <code>genius</code> variable, one can access the Genius API and retrieve the lyrics of any given song, such as “Too Many Nights” by Metro Boomin.</p>
<div id="95d1a134" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lyricsgenius</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">genius</span> <span class="op">=</span> lyricsgenius.Genius(access_token) <span class="co"># Initialize Genius API</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>song <span class="op">=</span> <span class="do">genius</span>.search_song(<span class="st">"Too Many Nights"</span>, <span class="st">"Metro Boomin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for "Too Many Nights" by Metro Boomin...
Done.</code></pre>
</div>
</div>
</section>
<section id="pre-processing-text-data" class="level3">
<h3 class="anchored" data-anchor-id="pre-processing-text-data">Pre-Processing Text Data</h3>
<p>Using the genius library, we define a function to fetch the lyrics of a song given the name and artist. Once retrieved, the next step is to pre-process the lyrics. This involves a cleaning process to eliminate patterns that may hinder the overall readability. The script contains the following steps:</p>
<div class="roundedlist">
<ol type="1">
<li>Fetching Track Lyrics</li>
<li>Expanding Contractions</li>
<li>Converting Text to Lowercase</li>
<li>Spell Checking + Censoring</li>
<li>Removing Punctuations</li>
<li>Tokenizing and encoding to ASCII</li>
</ol>
</div>
<!-- Overall, the `clean_song_lyrics` function extracts lyrics from Genius database, expands contractions, removes repetitive phrases, corrects spelling, eliminates profanity, and returns tokenized lyrics as a list of words.-->
<div id="3daa8a73" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="do">clean_song_lyrics</span>(song_name, artist_name):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fetch song lyrics and clean</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    lyrics <span class="op">=</span> get_song_lyrics(song_name, artist_name) </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    lyrics <span class="op">=</span> profanity.censor(contractions.fix(lyrics).lower(), censor_char<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    lyrics <span class="op">=</span> remove_punctuation(lyrics) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenizing and encoding to ASCII</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [word.encode(<span class="st">"ascii"</span>, <span class="st">"ignore"</span>).decode() <span class="cf">for</span> word <span class="kw">in</span> word_tokenize(lyrics)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="further-text-cleaning" class="level4">
<h4 class="anchored" data-anchor-id="further-text-cleaning">Further Text Cleaning</h4>
<p>We employ the Natural Language Toolkit (<em>NLTK</em>) to filter out stopwords and perform lemmatization. Removing common words like “the” condenses the text, allowing for a more thorough analysis of the lyrics’ core message. Lemmatization helps standardize text by transforming different verb variations into their most basic form.</p>
<div id="90b10b92" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">lyrics</th>
<th data-quarto-table-cell-role="th">stopwords_removed</th>
<th data-quarto-table-cell-role="th">lemmatized</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Please Please Please</td>
<td>Sabrina Carpenter</td>
<td>['i', 'know', 'i', 'have', 'good', 'judgment', 'i',...</td>
<td>['know', 'good', 'judgment', 'know', 'good', 'taste...</td>
<td>['know', 'good', 'judgment', 'know', 'good', 'taste...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Si Antes Te Hubiera Conocido</td>
<td>KAROL G</td>
<td>['what', 'what', 'we', 'are', 'in', 'a', 'relay', '...</td>
<td>['relay', 'summer', 'started', 'fire', 'would', 'me...</td>
<td>['relay', 'summer', 'start', 'fire', 'would', 'meet...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>BIRDS OF A FEATHER</td>
<td>Billie Eilish</td>
<td>['i', 'want', 'you', 'to', 'stay', 'til', 'i', 'am'...</td>
<td>['want', 'stay', 'til', 'grave', 'til', 'rot', 'awa...</td>
<td>['want', 'stay', 'til', 'grave', 'til', 'rot', 'awa...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="term-frequency-analysis" class="level4">
<h4 class="anchored" data-anchor-id="term-frequency-analysis">Term Frequency Analysis</h4>
<!-- Exploratory text analysis-->
<p>Let’s examine the most frequent words. Plotting the frequency distribution helps to determine the occurrence of the most common terms in our lyrical corpus.</p>
<iframe width="100%" height="360px" src="./01_sentiment_analysis/html/lyrics.html" frameborder="0" allowfullscreen="" style="margin-bottom: -5px;">
</iframe>
<hr>
</section>
</section>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
<p>The next process involves implementing pipelines to predict emotions and sentiment in textual content using transformer models designed for text classification and sentiment analysis. Three distinct pipelines are created, each equipped with different models.</p>
<div id="6af2eb41" class="cell" data-tags="[&quot;hide-output&quot;,&quot;hide-message&quot;,&quot;hide-warning&quot;]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> <span class="do">pipeline</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>classifiers <span class="op">=</span> [ <span class="co"># Initialize sentiment classifiers</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">pipeline</span>(model<span class="op">=</span><span class="st">'bhadresh-savani/distilbert-base-uncased-emotion'</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">pipeline</span>(model<span class="op">=</span><span class="st">'cardiffnlp/twitter-roberta-base-sentiment'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One of the classifiers is the <em>distilbert-base-uncased-emotion</em> model, which detects emotions in texts like sadness, joy, love, anger, fear, and surprise. Another classifier is the <em>roBERTa-base</em> model “trained on 58 million tweets and fine-tuned for sentiment analysis using the TweetEval benchmark” (EMNLP 2020).</p>
<p>We then implement the <code>get_lyric_sentiment</code> function, which uses three classifiers to calculate sentiment scores from pre-processed lyrics.</p>
<div id="f392c729" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform sentiment analysis</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="do">get_lyric_sentiment</span>(lyrics, classifiers):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">" "</span>.join(lyrics)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> classifier <span class="kw">in</span> classifiers:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            predictions <span class="op">=</span> classifier(text, truncation<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> prediction <span class="kw">in</span> predictions[<span class="dv">0</span>]:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                scores[prediction[<span class="st">"label"</span>]] <span class="op">=</span> prediction[<span class="st">"score"</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Error during sentiment analysis: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is a graphical representation of the results obtained from the <em>roBERTa-base</em> model. According to the <strong>TweetEval</strong> reference paper and official Github repository, the resulting labels <code>0</code>, <code>1</code>, and <code>2</code> correspond to Negative, Neutral, and Positive, respectively.</p>
<iframe width="100%" height="200px" src="./01_sentiment_analysis/html/roBERTa.html" frameborder="0" allowfullscreen="" style="margin-bottom: 0px;">
</iframe>
<hr>
</section>
<section id="putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="putting-it-all-together">Putting it All Together</h2>
<p>To summarize, the code efficiently collects data and performs text analysis on every song in a playlist. Specifically, it systematically processes a list of tracks and corresponding artists while simultaneously conducting a thorough cleaning procedure on the lyrics. Additionally, the program computes a sentiment score for each song based on the lyrics, indicating whether the lyrics are positive, negative, or neutral.</p>
<div id="b4a4e177" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="18">
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">album</th>
<th data-quarto-table-cell-role="th">artist</th>
<th data-quarto-table-cell-role="th">release_date</th>
<th data-quarto-table-cell-role="th">length</th>
<th data-quarto-table-cell-role="th">popularity</th>
<th data-quarto-table-cell-role="th">artist_pop</th>
<th data-quarto-table-cell-role="th">artist_genres</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">joy</th>
<th data-quarto-table-cell-role="th">love</th>
<th data-quarto-table-cell-role="th">anger</th>
<th data-quarto-table-cell-role="th">fear</th>
<th data-quarto-table-cell-role="th">surprise</th>
<th data-quarto-table-cell-role="th">LABEL_0</th>
<th data-quarto-table-cell-role="th">LABEL_1</th>
<th data-quarto-table-cell-role="th">LABEL_2</th>
<th data-quarto-table-cell-role="th">NEGATIVE</th>
<th data-quarto-table-cell-role="th">POSITIVE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Please Please Please</td>
<td>Please Please Please</td>
<td>Sabrina Carpenter</td>
<td>2024-06-06</td>
<td>186365</td>
<td>98</td>
<td>91</td>
<td>['pop']</td>
<td>0.274</td>
<td>0.669</td>
<td>...</td>
<td>0.955393</td>
<td>0.035888</td>
<td>0.002778</td>
<td>0.000637</td>
<td>0.000841</td>
<td>0.251058</td>
<td>0.542962</td>
<td>0.205980</td>
<td>0.857851</td>
<td>0.142149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Si Antes Te Hubiera Conocido</td>
<td>Si Antes Te Hubiera Conocido</td>
<td>KAROL G</td>
<td>2024-06-21</td>
<td>195824</td>
<td>91</td>
<td>89</td>
<td>['reggaeton', 'reggaeton colombiano', 'trap latino'...</td>
<td>0.446</td>
<td>0.924</td>
<td>...</td>
<td>0.003352</td>
<td>0.008062</td>
<td>0.982214</td>
<td>0.002481</td>
<td>0.000541</td>
<td>0.043676</td>
<td>0.469266</td>
<td>0.487059</td>
<td>0.957238</td>
<td>0.042762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>BIRDS OF A FEATHER</td>
<td>HIT ME HARD AND SOFT</td>
<td>Billie Eilish</td>
<td>2024-05-17</td>
<td>210373</td>
<td>98</td>
<td>94</td>
<td>['art pop', 'pop']</td>
<td>0.200</td>
<td>0.747</td>
<td>...</td>
<td>0.180090</td>
<td>0.008181</td>
<td>0.068175</td>
<td>0.434426</td>
<td>0.034063</td>
<td>0.122799</td>
<td>0.504202</td>
<td>0.372999</td>
<td>0.959893</td>
<td>0.040107</td>
</tr>
</tbody>
</table>

<p>3 rows × 33 columns</p>
</div>
</div>
</div>
</div>
<p>In summary, the above code aims to collect and refine song lyrics by eliminating stopwords and conducting lemmatization. Subsequently, it employs pre-trained models for sentiment analysis to determine the prevailing emotion conveyed in the lyrics. Finally, the program compiles all this information into a dataframe for further analysis.</p>
<hr>
</section>
<section id="correlations-matrix" class="level2">
<h2 class="anchored" data-anchor-id="correlations-matrix">Correlations Matrix</h2>
<p>After completing the initial data analysis, we proceed with generating the Pearson correlations matrix using the Pandas command <code>df.corr()</code>. Subsequently, we visualize the matrix using the seaborn heatmap, providing a detailed understanding of the relationships between the various variables in our dataset.</p>
<div id="bc666f30" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>track_sentiment_df <span class="op">=</span> df_final[[<span class="st">'name'</span>, <span class="st">'artist'</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'acousticness'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'instrumentalness'</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">'loudness'</span>, <span class="st">'speechiness'</span>, <span class="st">'tempo'</span>, <span class="st">'valence'</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">'sadness'</span>, <span class="st">'joy'</span>, <span class="st">'love'</span>, <span class="st">'anger'</span>, <span class="st">'fear'</span>, <span class="st">'surprise'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">'LABEL_0'</span>, <span class="st">'LABEL_1'</span>, <span class="st">'LABEL_2'</span>, <span class="st">'NEGATIVE'</span>, <span class="st">'POSITIVE'</span>]]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the pearson correlations matrix</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> track_sentiment_df.corr(method <span class="op">=</span> <span class="st">'pearson'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<iframe width="100%" height="450px" src="./01_sentiment_analysis/html/corr.html" frameborder="0" allowfullscreen="" style="margin-bottom: -5px;">
</iframe>
<p>The code below produces a scatterplot that showcases the correlation between energy and fear. The x-axis represents the energy value, while the y-axis represents the fear sentiment. The size of each data point corresponds to the label indicating the neutral sentiment level, and its color represents the valence value. Moreover, each bubble contains its energy value within, allowing for a straightforward interpretation of the data.</p>
<iframe width="100%" height="340px" src="./01_sentiment_analysis/html/corr_bubble1.html" frameborder="0" allowfullscreen="" style="margin-bottom: -5px;">
</iframe>
<p>Similarly, the scatterplot presented above utilizes the track sentiment data, comparing the energy and fear levels of the tracks based on valence and size.</p>
<hr>
</section>
<section id="principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis">Principal Component Analysis</h2>
<p>Principal Component Analysis (PCA) is a <strong>unsupervised</strong> dimension reduction algorithm. We implement PCA on a range of track audio features as well as emotional sentiments such as sadness, joy, love, anger, and more from our data. This lets us transform the data into fewer columns, reducing the dimensionality without losing significant information.</p>
<p>After performing PCA on the data, we apply it to generate a biplot depicting the relationship between the features and tracks. This biplot quickly reveals any discernible patterns and clusters within the dataset.</p>
<div id="7ab5b6f4" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X_SMALL <span class="op">=</span> df_final[[<span class="st">'acousticness'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'speechiness'</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'tempo'</span>, <span class="st">'valence'</span>, <span class="st">'sadness'</span>, <span class="st">'joy'</span>, <span class="st">'love'</span>, <span class="st">'anger'</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'fear'</span>, <span class="st">'surprise'</span>, <span class="st">'name'</span>, <span class="st">'LABEL_0'</span>, <span class="st">'LABEL_1'</span>, <span class="st">'LABEL_2'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We use the <code>PCA</code> and <code>StandardScaler</code>&nbsp;modules from the <code>sklearn</code> library. First, we select the first 12 columns from our data subset and form a matrix, named <span class="math inline">\(X_i\)</span>. We then standardize the data. Next, we apply PCA to the standardized data, <span class="math inline">\(X_{st}\)</span>. Lastly, we save the obtained loadings and eigenvalues.</p>
<div id="27baa0a4" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard scaling track audio features</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X_i <span class="op">=</span> X_SMALL.iloc[:,<span class="dv">0</span>:<span class="dv">12</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>X_st <span class="op">=</span>  StandardScaler().fit_transform(X_i)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply PCA to scaled data</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>pca_out <span class="op">=</span> pca.fit(X_st)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># component loadings</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>loadings <span class="op">=</span> pca_out.components_</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># get eigenvalues (variance explained by each PC)  </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>pca_out.explained_variance_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>array([2.65011368e+00, 1.78220617e+00, 1.32078217e+00, 1.23927771e+00,
       1.13536483e+00, 1.04777115e+00, 8.75900205e-01, 7.54116010e-01,
       6.06658820e-01, 5.67131303e-01, 2.65575917e-01, 7.98632974e-15])</code></pre>
</div>
</div>
<p>Next, the following code uses the <code>PCA()</code> function to calculate the PCA scores of the standardized data set, <span class="math inline">\(X_{st}\)</span>.</p>
<div id="38cc6e7e" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> X_i.columns.values <span class="co"># Labels</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>components <span class="op">=</span> pca.fit_transform(X_st) <span class="co"># PCA Score</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>loadings <span class="op">=</span> pca_out.components_.T <span class="op">*</span> np.sqrt(pca_out.explained_variance_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A biplot is generated based on the PCA scores and loadings, and the column names of the <span class="math inline">\(X_i\)</span> data frame are used as labels for the plot. The variance explained by the first two principal components are also displayed on the plot.</p>
<div id="23a8ff2e" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="24">
<div class="cell-output cell-output-display">
<div>                            <div id="baa590c5-bc84-45aa-9210-9be322d16014" class="plotly-graph-div" style="height:400px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("baa590c5-bc84-45aa-9210-9be322d16014")) {                    Plotly.newPlot(                        "baa590c5-bc84-45aa-9210-9be322d16014",                        [{"hovertemplate":"2=%{x}\u003cbr\u003e10=%{y}\u003cbr\u003e0=%{marker.color}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":[-0.6529410229507272,-1.1921088883104525,1.0803973460770857,-1.3063197129631825,-1.335645282807111,-0.8164227169471183,-1.6607144206070688,-1.7751464239035706,2.7539145374746443,-1.6242026170759172,-1.022032319657575,-1.666984292589261,2.1553980853380073,-1.7525751258712148,-1.1078269571848924,-0.39978048943973543,2.5969443307250675,1.3649169489353519,0.9619927234735535,1.4834300209427407,-2.619614155086019,-0.5537937474951462,-0.2775425716617555,2.2030539340358892,-1.276054602888579,0.021996215584201537,-1.1004522666675447,-0.7510236158004882,2.8317745644913237,3.1448527104560484,1.1411268492367292,0.4221072113344815,-0.9819724693151947,1.8719369471769913,-1.067349637351241,-2.9932998963220006,0.8374125070350272,-1.0834088348135023,-0.21583286991120715,2.073592442140298,2.608225588715174,2.071162331134727,2.100156299069605,-0.05030280103040167,1.1458261445636455,-2.4413867837503536,0.0027699760996006298,-1.2986233865622983,-1.055467984227936,-0.7941618208486989],"coloraxis":"coloraxis","symbol":"circle","size":7.5},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[0.2776007975899636,-0.6875708738841253,1.1294651556322115,0.5971857847311923,-0.08547631984434016,0.36439623754554057,0.08858615316682168,0.482335476182905,2.5708206102677753,0.21175568384329657,-0.3836718341790985,0.1131809439012467,-1.281747789318644,0.8645483348301155,1.2994468989550447,0.34467596886619706,-0.9231499679903055,-0.9227758136568818,-1.543725759127154,-1.477859530501295,-0.290973665945933,-0.47853982588131616,-0.3673580931540716,2.0385886017533705,-0.7798925923490967,-1.517167604661539,-0.832596890100365,-1.114215896416267,0.6921391937127778,-0.4162428020173477,-1.056663657182519,-0.4148899582443745,0.13940030043620963,-0.8879548037676493,0.4497225482034972,-0.472066054247392,0.3576574132782199,0.2631368203453167,0.16366869769973172,-1.173000784668452,2.8231970582022456,-1.8344099229043744,-1.0457037961305504,0.11028333749085019,2.1005167360405848,-0.7189552644632689,-0.7929800518967333,0.5303556221065605,-0.03000519572851415,3.5169303734799366],"xaxis":"x","y":[0.1480745627103491,-0.4298613617864686,-0.2876981905252528,0.7315282349792492,0.07271516618590558,-0.8558551651444758,0.18620915619398182,0.9015605657066007,0.27920946891619797,0.05237335567771286,-0.18836970862635125,-0.12062415479000847,-0.22825911177848945,0.8475934330302075,1.250397653236906,-0.44789019086717885,-0.35010699349737173,-0.00030950688478501086,0.01936698481372495,-0.9813697743111526,-0.5002277443083458,0.19110484920516294,-0.1848197028818856,0.6092974538987309,-0.13050784558276374,0.7684531381503334,0.5248429520971243,-0.8173280437612507,-0.23237830347640495,-0.2773695604085485,0.2815747724714443,-0.19300793712647044,-0.6170556438673953,0.4987521662887795,-0.23882733545995724,-0.02365506934922833,-0.7425093222723519,-0.7704122486485265,-0.2897687755238944,1.2344773666886486,-0.3390961204698993,0.5694103426297953,0.3310265871208446,-0.07450170240054389,-0.2883748813235694,0.32202400758954985,0.18047613915766864,-0.3841624296442471,-0.008689344159880659,0.002567812127778528],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"fillcolor":"black","line":{"color":"#2a3f5f","width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"PC2 (10.79%)","font":{"family":"Roboto Condensed","size":13,"color":"black"}},"gridcolor":"#eeeeee","gridwidth":1},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"PC10 (2.17%)","font":{"family":"Roboto Condensed","size":13,"color":"black"}},"gridcolor":"#eeeeee","gridwidth":1},"coloraxis":{"colorbar":{"title":{"text":"PC0","font":{"size":13,"family":"Roboto Condensed"}},"thickness":5,"lenmode":"pixels","dtick":1},"colorscale":[[0.0,"#A951E0"],[0.5,"#D0B6F7"],[1.0,"#6941FA"]]},"legend":{"tracegroupgap":0},"height":400,"width":800,"annotations":[{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":0.41201588319268256,"xanchor":"right","y":0.5681195005638003,"yanchor":"top"},{"ax":0,"ay":0,"text":"acousticness","x":0.41201588319268256,"xanchor":"center","y":0.5681195005638003,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.6982388798491203,"xanchor":"right","y":0.4365904669974574,"yanchor":"top"},{"ax":0,"ay":0,"text":"danceability","x":-0.6982388798491203,"xanchor":"center","y":0.4365904669974574,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.503144139243102,"xanchor":"right","y":-0.22641095800855046,"yanchor":"top"},{"ax":0,"ay":0,"text":"energy","x":-0.503144139243102,"xanchor":"center","y":-0.22641095800855046,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.3071887078237197,"xanchor":"right","y":0.5273854438468057,"yanchor":"top"},{"ax":0,"ay":0,"text":"speechiness","x":-0.3071887078237197,"xanchor":"center","y":0.5273854438468057,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":0.16633993256400056,"xanchor":"right","y":0.15007803998140265,"yanchor":"top"},{"ax":0,"ay":0,"text":"tempo","x":0.16633993256400056,"xanchor":"center","y":0.15007803998140265,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.7115864584668476,"xanchor":"right","y":0.20817348814970182,"yanchor":"top"},{"ax":0,"ay":0,"text":"valence","x":-0.7115864584668476,"xanchor":"center","y":0.20817348814970182,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":0.6452241572228861,"xanchor":"right","y":0.08256604912234528,"yanchor":"top"},{"ax":0,"ay":0,"text":"sadness","x":0.6452241572228861,"xanchor":"center","y":0.08256604912234528,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.6716065892301798,"xanchor":"right","y":-0.35571088571991527,"yanchor":"top"},{"ax":0,"ay":0,"text":"joy","x":-0.6716065892301798,"xanchor":"center","y":-0.35571088571991527,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.04975561318616488,"xanchor":"right","y":-0.4273071972405915,"yanchor":"top"},{"ax":0,"ay":0,"text":"love","x":-0.04975561318616488,"xanchor":"center","y":-0.4273071972405915,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.20869797084488803,"xanchor":"right","y":0.7248101401890222,"yanchor":"top"},{"ax":0,"ay":0,"text":"anger","x":-0.20869797084488803,"xanchor":"center","y":0.7248101401890222,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":0.44045047839792617,"xanchor":"right","y":0.17671354338182313,"yanchor":"top"},{"ax":0,"ay":0,"text":"fear","x":0.44045047839792617,"xanchor":"center","y":0.17671354338182313,"yanchor":"bottom","yshift":5},{"arrowhead":2,"arrowsize":2,"ax":0,"axref":"x","ay":0,"ayref":"y","showarrow":true,"x":-0.06228289226191055,"xanchor":"right","y":-0.032588024319481934,"yanchor":"top"},{"ax":0,"ay":0,"text":"surprise","x":-0.06228289226191055,"xanchor":"center","y":-0.032588024319481934,"yanchor":"bottom","yshift":5}],"font":{"family":"Roboto","size":13},"margin":{"r":10,"t":50,"b":50,"l":10},"title":{"font":{"size":13,"family":"Roboto Condensed"},"text":"\u003cb\u003eFigure 7.\u003c\u002fb\u003e Principal Component Analysis Biplot","automargin":true,"yref":"paper","xref":"paper"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('baa590c5-bc84-45aa-9210-9be322d16014');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Below is a preview of all the PCA clustered groups.</p>
<div id="03ec527d" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="25">
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PC1</th>
<th data-quarto-table-cell-role="th">PC2</th>
<th data-quarto-table-cell-role="th">PC3</th>
<th data-quarto-table-cell-role="th">PC4</th>
<th data-quarto-table-cell-role="th">PC5</th>
<th data-quarto-table-cell-role="th">PC6</th>
<th data-quarto-table-cell-role="th">PC7</th>
<th data-quarto-table-cell-role="th">PC8</th>
<th data-quarto-table-cell-role="th">PC9</th>
<th data-quarto-table-cell-role="th">PC10</th>
<th data-quarto-table-cell-role="th">PC11</th>
<th data-quarto-table-cell-role="th">PC12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.652941</td>
<td>-0.540595</td>
<td>0.277601</td>
<td>-1.276863</td>
<td>0.412919</td>
<td>-0.207641</td>
<td>-0.019832</td>
<td>0.451893</td>
<td>-0.773699</td>
<td>-0.432625</td>
<td>0.148075</td>
<td>-1.635591e-08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.192109</td>
<td>3.319574</td>
<td>-0.687571</td>
<td>1.032594</td>
<td>0.775812</td>
<td>-0.537727</td>
<td>-1.541805</td>
<td>-0.796704</td>
<td>-0.756995</td>
<td>0.949406</td>
<td>-0.429861</td>
<td>8.099381e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.080397</td>
<td>0.204470</td>
<td>1.129465</td>
<td>-0.305987</td>
<td>0.566007</td>
<td>0.881001</td>
<td>-0.641871</td>
<td>0.360368</td>
<td>0.671404</td>
<td>0.286174</td>
<td>-0.287698</td>
<td>-1.186518e-07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.306320</td>
<td>-0.990882</td>
<td>0.597186</td>
<td>-1.050503</td>
<td>0.141820</td>
<td>-0.638868</td>
<td>-0.483447</td>
<td>0.085446</td>
<td>0.096276</td>
<td>0.019933</td>
<td>0.731528</td>
<td>7.415103e-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.335645</td>
<td>-1.277782</td>
<td>-0.085476</td>
<td>-1.018065</td>
<td>0.395467</td>
<td>0.719844</td>
<td>-0.612023</td>
<td>0.245817</td>
<td>-0.426194</td>
<td>0.805717</td>
<td>0.072715</td>
<td>-9.832706e-08</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The variance ratios for the PCA output and the cumulative sum of the explained variance ratios are printed below. Specifically, the array displayed represents the amount of variability explained by each component.</p>
<div id="73733906" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pca_out.explained_variance_ratio_)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'----'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pca_out.explained_variance_ratio_.cumsum())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2.16425951e-01 1.45546837e-01 1.07863877e-01 1.01207680e-01
 9.27214608e-02 8.55679769e-02 7.15318501e-02 6.15861408e-02
 4.95438036e-02 4.63157231e-02 2.16886999e-02 6.52216928e-16]
----
[0.21642595 0.36197279 0.46983667 0.57104434 0.66376581 0.74933378
 0.82086563 0.88245177 0.93199558 0.9783113  1.         1.        ]</code></pre>
</div>
</div>
<p>The loading vectors help visualize the relationship between the original variables and their respective components. These vectors represent the weights of the variables within a mathematical equation used to generate the principal components.</p>
<div id="cc423252" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_weights <span class="op">=</span> pd.DataFrame(pca_out.components_.T, columns<span class="op">=</span>df_pca.columns, index<span class="op">=</span>X_i.columns)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PC1</th>
<th data-quarto-table-cell-role="th">PC2</th>
<th data-quarto-table-cell-role="th">PC3</th>
<th data-quarto-table-cell-role="th">PC4</th>
<th data-quarto-table-cell-role="th">PC5</th>
<th data-quarto-table-cell-role="th">PC6</th>
<th data-quarto-table-cell-role="th">PC7</th>
<th data-quarto-table-cell-role="th">PC8</th>
<th data-quarto-table-cell-role="th">PC9</th>
<th data-quarto-table-cell-role="th">PC10</th>
<th data-quarto-table-cell-role="th">PC11</th>
<th data-quarto-table-cell-role="th">PC12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">acousticness</td>
<td>0.253094</td>
<td>0.425560</td>
<td>-0.081137</td>
<td>-0.051999</td>
<td>0.120657</td>
<td>-0.270423</td>
<td>0.038467</td>
<td>0.565513</td>
<td>-0.512979</td>
<td>-0.059977</td>
<td>-0.264270</td>
<td>-2.786806e-08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">danceability</td>
<td>-0.428916</td>
<td>0.327036</td>
<td>-0.026959</td>
<td>-0.109895</td>
<td>0.101021</td>
<td>0.030147</td>
<td>-0.217469</td>
<td>0.138922</td>
<td>0.523550</td>
<td>-0.012503</td>
<td>-0.586779</td>
<td>4.801649e-10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">energy</td>
<td>-0.309072</td>
<td>-0.169597</td>
<td>-0.250304</td>
<td>0.309696</td>
<td>-0.430665</td>
<td>0.106693</td>
<td>0.308849</td>
<td>0.025428</td>
<td>-0.270576</td>
<td>0.482465</td>
<td>-0.343909</td>
<td>-2.016976e-08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">speechiness</td>
<td>-0.188700</td>
<td>0.395047</td>
<td>-0.062115</td>
<td>-0.032742</td>
<td>-0.118204</td>
<td>0.304929</td>
<td>0.670314</td>
<td>-0.052322</td>
<td>0.033915</td>
<td>-0.472329</td>
<td>0.141921</td>
<td>6.140892e-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">tempo</td>
<td>0.102180</td>
<td>0.112419</td>
<td>0.250471</td>
<td>0.222759</td>
<td>-0.388726</td>
<td>-0.698286</td>
<td>0.097755</td>
<td>-0.348045</td>
<td>0.104721</td>
<td>-0.220550</td>
<td>-0.188555</td>
<td>9.069694e-09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">valence</td>
<td>-0.437115</td>
<td>0.155936</td>
<td>0.052694</td>
<td>0.248609</td>
<td>-0.017721</td>
<td>-0.338282</td>
<td>-0.003064</td>
<td>0.417016</td>
<td>0.182694</td>
<td>0.208423</td>
<td>0.595445</td>
<td>-1.736405e-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sadness</td>
<td>0.396350</td>
<td>0.061848</td>
<td>-0.457667</td>
<td>-0.064144</td>
<td>-0.420210</td>
<td>0.034624</td>
<td>-0.077819</td>
<td>0.190498</td>
<td>0.359314</td>
<td>0.010301</td>
<td>0.101546</td>
<td>5.156194e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">joy</td>
<td>-0.412556</td>
<td>-0.266452</td>
<td>0.186634</td>
<td>-0.496523</td>
<td>-0.074336</td>
<td>-0.157048</td>
<td>0.007957</td>
<td>0.032509</td>
<td>-0.274236</td>
<td>-0.148999</td>
<td>-0.020153</td>
<td>5.901792e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">love</td>
<td>-0.030564</td>
<td>-0.320082</td>
<td>-0.212120</td>
<td>0.566633</td>
<td>0.503138</td>
<td>-0.097366</td>
<td>0.140785</td>
<td>0.062050</td>
<td>0.057297</td>
<td>-0.303900</td>
<td>-0.150700</td>
<td>3.548201e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">anger</td>
<td>-0.128199</td>
<td>0.542932</td>
<td>-0.134174</td>
<td>0.206550</td>
<td>0.133607</td>
<td>0.089812</td>
<td>-0.313582</td>
<td>-0.502087</td>
<td>-0.289683</td>
<td>0.161095</td>
<td>0.126852</td>
<td>3.547164e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">fear</td>
<td>0.270561</td>
<td>0.132370</td>
<td>0.620053</td>
<td>0.077554</td>
<td>0.159411</td>
<td>0.149327</td>
<td>0.334458</td>
<td>0.064617</td>
<td>0.185699</td>
<td>0.427809</td>
<td>-0.083975</td>
<td>3.612335e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">surprise</td>
<td>-0.038259</td>
<td>-0.024411</td>
<td>0.410989</td>
<td>0.395483</td>
<td>-0.381912</td>
<td>0.392240</td>
<td>-0.401021</td>
<td>0.254973</td>
<td>-0.134342</td>
<td>-0.353076</td>
<td>-0.027541</td>
<td>6.012030e-02</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<hr>
</section>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">K Means Clustering</h2>
<blockquote class="blockquote">
<p>Clustering is an unsupervised machine learning technique used to categorize data points into distinct groups based on their similarities. In Spotify data, for example, clustering can categorize songs into genres or moods by analyzing characteristics like tempo, beat, and instrumentals.</p>
</blockquote>
<p>Next, we apply K-means clustering on the dimensionally reduced Spotify data to explore patterns in track audio features and sentiment. K-means is an unsupervised algorithm that optimizes the number of clusters (<span class="math inline">\(K\)</span>). We use the Elbow method to determine the optimal <span class="math inline">\(K\)</span>.</p>
<p>As shown below, we use the KMeans algorithm from the <em>sklearn.cluster</em> library to categorize songs based on features like energy levels and sound qualities. Applying this to the “playlist_tracks” dataset, we create three <a href="https://github.com/ankushbharadwaj/reorganize-my-spotify-playlist/blob/master/reorder%20my%20spotify%20playlist.ipynb">clusters</a>, excluding the “artist” and “name” columns to focus on track features.</p>
<div id="4724bc05" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>playlist_tracks <span class="op">=</span> df_final[[<span class="st">'name'</span>,<span class="st">'acousticness'</span>,<span class="st">'danceability'</span>,<span class="st">'energy'</span>, <span class="st">'liveness'</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'instrumentalness'</span>,<span class="st">'speechiness'</span>,<span class="st">'valence'</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'sadness'</span>, <span class="st">'joy'</span>, <span class="st">'love'</span>, <span class="st">'anger'</span>, <span class="st">'fear'</span>, ]]<span class="co">#'surprise'</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>kmeans.fit(playlist_tracks.drop([<span class="st">'name'</span>], axis <span class="op">=</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=3)</pre></div></div></div></div></div>
</div>
</div>
<div id="6272ae27" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="29">
<div class="cell-output cell-output-display">
<div>                            <div id="30d69821-68b7-4144-9cf5-1f29e3511955" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("30d69821-68b7-4144-9cf5-1f29e3511955")) {                    Plotly.newPlot(                        "30d69821-68b7-4144-9cf5-1f29e3511955",                        [{"histfunc":"count","marker":{"color":"#6A8559","line":{"color":"#4E6241","width":1.5}},"showlegend":false,"textfont":{"color":"black","family":"Roboto","size":18},"x":["1","0","0","1","1","1","1","1","0","1","1","1","2","1","1","1","2","2","2","2","1","0","1","0","0","2","0","0","0","2","0","0","1","2","1","1","0","1","0","0","0","2","2","0","0","0","0","1","1","0"],"type":"histogram","cliponaxis":false,"opacity":0.996,"textangle":0,"textposition":"outside"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"title":{"text":"Count","font":{"size":11,"family":"Roboto Condensed","color":"black"},"standoff":1},"tickfont":{"size":10,"family":"Roboto","color":"black"}},"yaxis":{"tickfont":{"size":12,"family":"Roboto","color":"black"}},"font":{"family":"Roboto Condensed"},"title":{"font":{"size":15,"family":"Roboto Condensed"},"text":"\u003cb\u003eFigure 8.\u003c\u002fb\u003e KMeans Clustering (n_clusters=3)","automargin":true},"barmode":"group","bargap":0.125,"bargroupgap":0.1},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('30d69821-68b7-4144-9cf5-1f29e3511955');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<section id="visualizing-the-clusters" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-the-clusters">Visualizing the Clusters</h4>
<p>Moving forward, let’s look at differences in the audio features of each group.</p>
<div id="746d27c7" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>scaler.fit(playlist_tracks.drop([<span class="st">'name'</span>], axis <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="op">=</span> scaler.transform(playlist_tracks.drop([<span class="st">'name'</span>], axis <span class="op">=</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="533b025e" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components <span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>pca.fit(scaled_data)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>data_pca <span class="op">=</span> pca.transform(scaled_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a76c21c6" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="32">
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>Text(0, 0.5, 'PC2: 0.153')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-33-output-2.png" width="677" height="472" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="24f0f30d" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>playlist_tracks[<span class="st">'group'</span>] <span class="op">=</span> <span class="bu">list</span>(kmeans.labels_)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>playlist_tracks <span class="op">=</span> playlist_tracks.astype({<span class="st">'group'</span>: <span class="bu">str</span>})</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>means <span class="op">=</span> pd.DataFrame(index <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">3</span>), </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                    columns <span class="op">=</span> <span class="bu">list</span>(playlist_tracks[playlist_tracks[<span class="st">'group'</span>] <span class="op">==</span> <span class="st">'0'</span>].describe().loc[<span class="st">'mean'</span>].index))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>means.iloc[<span class="dv">0</span>] <span class="op">=</span> playlist_tracks[playlist_tracks[<span class="st">'group'</span>] <span class="op">==</span> <span class="st">'0'</span>].describe().loc[<span class="st">'mean'</span>]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>means.iloc[<span class="dv">1</span>] <span class="op">=</span> playlist_tracks[playlist_tracks[<span class="st">'group'</span>] <span class="op">==</span> <span class="st">'1'</span>].describe().loc[<span class="st">'mean'</span>]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>means.iloc[<span class="dv">2</span>] <span class="op">=</span> playlist_tracks[playlist_tracks[<span class="st">'group'</span>] <span class="op">==</span> <span class="st">'2'</span>].describe().loc[<span class="st">'mean'</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">sadness</th>
<th data-quarto-table-cell-role="th">joy</th>
<th data-quarto-table-cell-role="th">love</th>
<th data-quarto-table-cell-role="th">anger</th>
<th data-quarto-table-cell-role="th">fear</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.20839</td>
<td>0.672</td>
<td>0.60875</td>
<td>0.144285</td>
<td>0.020388</td>
<td>0.059735</td>
<td>0.54265</td>
<td>0.151202</td>
<td>0.108936</td>
<td>0.206101</td>
<td>0.253816</td>
<td>0.259347</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.126155</td>
<td>0.74595</td>
<td>0.67765</td>
<td>0.110685</td>
<td>0.017031</td>
<td>0.052625</td>
<td>0.6812</td>
<td>0.028329</td>
<td>0.854914</td>
<td>0.046817</td>
<td>0.0533</td>
<td>0.013642</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.3229</td>
<td>0.615</td>
<td>0.6254</td>
<td>0.13608</td>
<td>0.000763</td>
<td>0.0478</td>
<td>0.4399</td>
<td>0.893231</td>
<td>0.046527</td>
<td>0.002716</td>
<td>0.032235</td>
<td>0.023872</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<hr>
</section>
<section id="organized-songs-in-a-playlist" class="level4">
<h4 class="anchored" data-anchor-id="organized-songs-in-a-playlist">Organized Songs in a Playlist</h4>
<p>K-means is an unsupervised clustering algorithm that partitions data into <span class="math inline">\(K\)</span> clusters, grouping similar points together. Using Spotify data, we can cluster songs based on attributes like acousticness, danceability, and energy. We import Python libraries such as pandas, matplotlib, and sklearn for data manipulation, visualization, and clustering. After obtaining song attributes, we use the <code>describe</code> function to gain insights and prepare the data for clustering, as demonstrated below.</p>
<div id="4f3b6ec4" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> cluster, decomposition</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> df_final[[<span class="st">'name'</span>,<span class="st">'acousticness'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'instrumentalness'</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'liveness'</span>, <span class="st">'speechiness'</span>, <span class="st">'valence'</span>,  <span class="st">'loudness_scaled'</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'anger'</span>, <span class="st">'love'</span>, <span class="st">'sadness'</span>]]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>songs.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">loudness_scaled</th>
<th data-quarto-table-cell-role="th">anger</th>
<th data-quarto-table-cell-role="th">love</th>
<th data-quarto-table-cell-role="th">sadness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
<td>50.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.198398</td>
<td>0.690180</td>
<td>0.639640</td>
<td>0.015120</td>
<td>0.129204</td>
<td>0.054504</td>
<td>0.577520</td>
<td>0.551367</td>
<td>0.129293</td>
<td>0.101710</td>
<td>0.250459</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.194310</td>
<td>0.144655</td>
<td>0.130139</td>
<td>0.059203</td>
<td>0.079672</td>
<td>0.032362</td>
<td>0.234215</td>
<td>0.221284</td>
<td>0.244960</td>
<td>0.245032</td>
<td>0.356076</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000938</td>
<td>0.264000</td>
<td>0.386000</td>
<td>0.000000</td>
<td>0.029300</td>
<td>0.026400</td>
<td>0.190000</td>
<td>0.000000</td>
<td>0.000206</td>
<td>0.000193</td>
<td>0.001261</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.040675</td>
<td>0.630500</td>
<td>0.552000</td>
<td>0.000000</td>
<td>0.082600</td>
<td>0.034775</td>
<td>0.373000</td>
<td>0.376041</td>
<td>0.002251</td>
<td>0.002018</td>
<td>0.007991</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.140000</td>
<td>0.700500</td>
<td>0.635000</td>
<td>0.000003</td>
<td>0.106000</td>
<td>0.046450</td>
<td>0.591500</td>
<td>0.581936</td>
<td>0.026904</td>
<td>0.006858</td>
<td>0.041605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.270750</td>
<td>0.780000</td>
<td>0.727250</td>
<td>0.000082</td>
<td>0.139250</td>
<td>0.063300</td>
<td>0.775500</td>
<td>0.699484</td>
<td>0.124115</td>
<td>0.032315</td>
<td>0.401728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.799000</td>
<td>0.936000</td>
<td>0.946000</td>
<td>0.336000</td>
<td>0.403000</td>
<td>0.204000</td>
<td>0.957000</td>
<td>1.000000</td>
<td>0.993250</td>
<td>0.994453</td>
<td>0.998848</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The first step is to extract song labels from the dataset. We then select key features to input into the Affinity Propagation clustering algorithm from the <em>scikit-learn</em> library. We set a preference value of -200 to optimize clustering performance. After inputting the data, we train the algorithm to cluster the Spotify songs effectively.</p>
<div id="dda942e6" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> songs.values[:,<span class="dv">0</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> songs.values[:,<span class="dv">1</span>:<span class="dv">12</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> cluster.AffinityPropagation()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>kmeans.fit(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>AffinityPropagation()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">AffinityPropagation</label><div class="sk-toggleable__content"><pre>AffinityPropagation()</pre></div></div></div></div></div>
</div>
</div>
<div id="e3a0369d" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="36">
<div class="cell-output cell-output-stdout">
<pre><code>Category 0
-----
Please Please Please
Not Like Us
Beautiful Things
LUNCH
End of Beginning
Belong Together
Slow It Down
the boy is mine
360
Rockstar
One Of The Girls (with JENNIE, Lily Rose Depp)
Parking Lot
Gata Only
Santa
Magnetic

Category 1
-----
Si Antes Te Hubiera Conocido
Nasty
greedy
BAND4BAND (feat. Lil Baby)

Category 2
-----
BIRDS OF A FEATHER
we can't be friends (wait for your love)
Tough
Fortnight (feat. Post Malone)
Close To You
Stumblin' In
Scared To Start

Category 5
-----
Good Luck, Babe!
A Bar Song (Tipsy)
MILLION DOLLAR BABY
Too Sweet
I Had Some Help (Feat. Morgan Wallen)
Espresso
i like the way you kiss me
Houdini
I Don't Wanna Wait
Smeraldo Garden Marching Band (feat. Loco)
Water
Illusion

Category 3
-----
Stargazing
Lose Control
Austin
I Can Do It With a Broken Heart
GIRLS
Saturn
Stick Season
Lies Lies Lies
feelslikeimfallinginlove

Category 4
-----
HOT TO GO!
Move
28
</code></pre>
</div>
</div>
<p>The script effectively categorized the playlist into six distinct groups based on shared features, resulting in a diverse selection of songs within each category.</p>
<hr>
</section>
</section>
<section id="supervised-learning-similarity-search" class="level2">
<h2 class="anchored" data-anchor-id="supervised-learning-similarity-search">Supervised Learning: Similarity Search</h2>
<p>We create a query to retrieve <a href="https://www.kaggle.com/code/leomauro/spotify-songs-similarity-search/notebook">similar songs based on Euclidean distance</a>, where a shorter distance indicates greater similarity. Additionally, we employ the K-nearest neighbors (KNN) algorithm, a supervised learning method that classifies songs based on known data.</p>
<section id="knn-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="knn-algorithm">KNN Algorithm</h4>
<blockquote class="blockquote">
<p>K-nearest neighbors (KNN) is a supervised algorithm for classification and regression. It predicts the category of new data points by comparing them to the K nearest neighbors with known classifications. For example, KNN can classify Spotify songs by analyzing their features and comparing them to similar, previously classified tracks.</p>
</blockquote>
<p>The KNN algorithm identifies <span class="math inline">\(k\)</span> similar elements around a query point. Using the <code>knnQuery</code> function, we input a query point (a specific song and artist), characteristic points, and a value for <span class="math inline">\(k\)</span>. This function calculates the Euclidean distance between the query point and each data point, returning the <span class="math inline">\(k\)</span> closest points.</p>
<p>The <code>querySimilars</code> function then applies KNN to find and return the <span class="math inline">\(k\)</span> most similar songs based on specified features.</p>
<div id="da1d28e3" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a song string search</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getMusicName(elem):</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>elem[<span class="st">'artist'</span>]<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>elem[<span class="st">'name'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knnQuery(queryPoint, arrCharactPoints, k):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    queryVals <span class="op">=</span> queryPoint.tolist()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    distVals <span class="op">=</span> []</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Copy of data indices and data</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> arrCharactPoints.copy(deep <span class="op">=</span> <span class="va">True</span>)  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, row <span class="kw">in</span> tmp.iterrows():</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        feat <span class="op">=</span> row.values.tolist()</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate sum of squared differences</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        ssd <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">abs</span>(feat[i] <span class="op">-</span> queryVals[i]) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(queryVals)))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get euclidean distance</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        distVals.append(ssd <span class="op">**</span> <span class="fl">0.5</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    tmp[<span class="st">'distance'</span>] <span class="op">=</span> distVals</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tmp.sort_values(<span class="st">'distance'</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># K closest and furthest points</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmp.head(k).index, tmp.tail(k).index</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute KNN removing the query point</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> querySimilar(df, columns, idx, func, param):</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> df[columns].copy(deep <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    queryPoint <span class="op">=</span> arr.loc[idx]</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> arr.drop([idx])</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> func(queryPoint, arr, param)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>KNN Query Example.</strong></p>
<p>Now we perform a KNN query to find the k most similar songs based on specified features. We first establish a function to generate custom query points. The code snippet below then selects specific song features and finds the top <span class="math inline">\(k\)</span> values within that feature set.</p>
<!--Using the *sklearn* preprocessing library, we create a scaler to normalize features. Since all feature values range between 0 and 1, except for loudness, we scale loudness to fit within this range.-->
<p>Let’s search for <span class="math inline">\(k=3\)</span> similar songs to a query point <span class="math inline">\(\textrm{songIndex} = 6\)</span>.</p>
<div id="427b2c86" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select song and column attributes</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>songIndex <span class="op">=</span> <span class="dv">4</span> <span class="co"># query point</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">'acousticness'</span>, <span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'instrumentalness'</span>, <span class="st">'liveness'</span>, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">'loudness_scaled'</span>, <span class="st">'tempo'</span>, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">'speechiness'</span>, <span class="st">'valence'</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set query parameters</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>func, param <span class="op">=</span> knnQuery,<span class="dv">3</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement query</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> querySimilar(df, columns, songIndex, func, param)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"---- Query Point ----"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(getMusicName(df.loc[songIndex]))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'---- k = 3 similar songs ----'</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> track_id <span class="kw">in</span> response[<span class="dv">0</span>]:</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    track_name <span class="op">=</span> getMusicName(df.loc[track_id])</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(track_name)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'---- k = 3 nonsimilar songs ----'</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> track_id <span class="kw">in</span> response[<span class="dv">1</span>]:</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    track_name <span class="op">=</span> getMusicName(df.loc[track_id])</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(track_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---- Query Point ----
Shaboozey - A Bar Song (Tipsy)
---- k = 3 similar songs ----
Morgan Wallen - Lies Lies Lies
Zach Bryan - 28
The Weeknd - One Of The Girls (with JENNIE, Lily Rose Depp)
---- k = 3 nonsimilar songs ----
SZA - Saturn
Benson Boone - Slow It Down
Taylor Swift - Fortnight (feat. Post Malone)</code></pre>
</div>
</div>
<p>The code below extends the KNN algorithm to query each track in a playlist rather than a single defined query point.</p>
<p>To track the number of similar and non-similar songs, we use two dictionaries: <code>similar_count</code> and <code>nonsimilar_count</code>. A loop iterates through the playlist, running the <code>querySimilars</code> function on each track. The results are processed into “similar” and “non-similar” categories stored in the <code>response</code> variable.</p>
<div id="a1f41e82" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>similar_count <span class="op">=</span> {} <span class="co"># Similar songs count</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>nonsimilar_count <span class="op">=</span> {} <span class="co"># Non-similar songs count</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> track_index <span class="kw">in</span> df.index:</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Implement query</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> querySimilar(df, columns, track_index, func, param)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get similar songs</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> similar_index <span class="kw">in</span> response[<span class="dv">0</span>]:</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        track <span class="op">=</span> getMusicName(df.loc[similar_index])</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> track <span class="kw">in</span> similar_count:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>            similar_count[track] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            similar_count[track] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get non-similar songs</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nonsimilar_index <span class="kw">in</span> response[<span class="dv">1</span>]:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        track <span class="op">=</span> getMusicName(df.loc[nonsimilar_index])</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> track <span class="kw">in</span> nonsimilar_count:</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            nonsimilar_count[track] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            nonsimilar_count[track] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c6b6330e" class="cell" data-tags="[&quot;hide-code&quot;]" data-execution_count="41">
<div class="cell-output cell-output-stdout">
<pre><code>---- NON SIMILAR SONG COUNTS ----
Benson Boone - Slow It Down : 39
Taylor Swift - Fortnight (feat. Post Malone) : 39
SZA - Saturn : 36
Zach Bryan - 28 : 14
Morgan Wallen - Lies Lies Lies : 11
Shaboozey - A Bar Song (Tipsy) : 11

---- SIMILAR SONG COUNTS ----
Rvssian - Santa : 6
Dua Lipa - Illusion : 5
Hozier - Too Sweet : 5
The Weeknd - One Of The Girls (with JENNIE, Lily Rose Depp) : 5
Mustard - Parking Lot : 5
Tinashe - Nasty : 5
Chappell Roan - Good Luck, Babe! : 5
Djo - End of Beginning : 5</code></pre>
</div>
</div>
<hr>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01_sentiment_analysis/01_data.html" class="pagination-link" aria-label="Extracting Spotify Data">
        <span class="nav-page-text"><span class="chapter-title">Extracting Spotify Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>